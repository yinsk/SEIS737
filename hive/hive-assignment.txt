drop table WindowsUpdate;

create table WindowsUpdate
(Evendate string, Time string, PID INT, TID INT, Component string, Text string)
Row format delimited
Fields terminated by '\t'
Lines terminated by '\n'
Stored as textfile;

LOAD DATA LOCAL INPATH '/home/training/hive/WindowsUpdate(1).log' OVERWRITE INTO TABLE WindowsUpdate;

select count(*) from WindowsUpdate;
14835

select Component, count(*) 
from WindowsUpdate
GROUP BY Component;

AU      1712
Agent   2728
DnldMgr 2149
Driver  78
DtaStor 459
Handler 1086
Misc    1137
PT      116
Report  799
Service 132
Setup   323
Shutdwn 4116

select Evendate, count(*) 
from WindowsUpdate
GROUP BY Evendate;

2014-03-07      841
2014-03-08      1269
2014-03-09      174
2014-03-10      140
2014-03-11      2823
2014-03-12      284
2014-03-13      227
2014-03-14      250
2014-03-16      274
2014-03-17      242
2014-03-18      169
2014-03-19      348
2014-03-20      247
2014-03-21      181
2014-03-27      247
2014-03-28      246
2014-03-29      179
2014-03-30      170
2014-03-31      143
2014-04-01      243
2014-04-02      170
2014-04-03      142
2014-04-04      248
2014-04-06      171
2014-04-07      147
2014-04-08      247
2014-04-09      750
2014-04-10      4065
2014-04-11      197
2014-03-07      1

SELECT count(*) 
FROM WindowsUpdate
WHERE Text LIKE '%DnldMgr: New download job%';

444


select Evendate, count(*) 
from WindowsUpdate
WHERE Text LIKE '%DnldMgr: New download job%'
GROUP BY Evendate;

2014-03-07      86
2014-03-11      132
2014-03-12      8
2014-03-13      3
2014-03-14      5
2014-03-16      8
2014-03-17      9
2014-03-18      1
2014-03-19      2
2014-04-09      81
2014-04-10      108
2014-04-11      1


select Evendate, time 
from WindowsUpdate
WHERE Text LIKE '%DnldMgr: New download job%'
AND Evendate = '2014-03-11';

2014-03-11      12:12:20:485
2014-03-11      12:12:20:540
2014-03-11      12:12:23:025
2014-03-11      12:12:23:088
2014-03-11      12:12:23:325
2014-03-11      12:12:23:555
2014-03-11      12:12:23:633
2014-03-11      12:12:23:859
2014-03-11      12:12:23:964
2014-03-11      12:12:24:244
2014-03-11      12:12:24:314
2014-03-11      12:12:24:536
2014-03-11      12:12:24:541
2014-03-11      12:12:24:541
2014-03-11      12:12:24:709
2014-03-11      12:12:24:709
2014-03-11      12:12:24:946
2014-03-11      12:12:24:946
2014-03-11      12:12:25:021
2014-03-11      12:12:25:024
2014-03-11      12:12:25:236
2014-03-11      12:12:25:236
2014-03-11      12:12:25:291
2014-03-11      12:12:25:291
2014-03-11      12:12:25:719
2014-03-11      12:12:25:719
2014-03-11      12:12:25:896
2014-03-11      12:12:25:899
2014-03-11      12:12:26:287
2014-03-11      12:12:26:287
2014-03-11      12:12:26:364
2014-03-11      12:12:26:367
2014-03-11      12:12:26:704
2014-03-11      12:12:26:707
2014-03-11      12:12:26:794
2014-03-11      12:12:26:797
2014-03-11      12:12:37:869
2014-03-11      12:12:37:872
2014-03-11      12:13:02:575
2014-03-11      12:13:02:775
2014-03-11      12:13:02:892
2014-03-11      12:13:02:892
2014-03-11      12:13:02:987
2014-03-11      12:13:02:990
2014-03-11      12:13:03:127
2014-03-11      12:13:03:192
2014-03-11      12:13:03:275
2014-03-11      12:13:03:275
2014-03-11      12:13:08:192
2014-03-11      12:13:08:362
2014-03-11      12:13:08:457
2014-03-11      12:13:08:457
2014-03-11      12:13:08:535
2014-03-11      12:13:08:537
2014-03-11      12:13:08:640
2014-03-11      12:13:08:640
2014-03-11      12:13:22:827
2014-03-11      12:13:23:337
2014-03-11      12:13:23:530
2014-03-11      12:13:23:530
2014-03-11      12:13:23:662
2014-03-11      12:13:23:662
2014-03-11      12:13:23:742
2014-03-11      12:13:23:742
2014-03-11      12:13:23:820
2014-03-11      12:13:23:820
2014-03-11      12:13:23:885
2014-03-11      12:13:23:885
2014-03-11      12:13:28:662
2014-03-11      12:13:28:662
2014-03-11      12:13:29:635
2014-03-11      12:13:29:637
2014-03-11      12:13:34:158
2014-03-11      12:13:34:158
2014-03-11      12:13:34:495
2014-03-11      12:13:34:495
2014-03-11      12:13:34:788
2014-03-11      12:13:34:788
2014-03-11      12:13:34:858
2014-03-11      12:13:34:858
2014-03-11      12:13:39:328
2014-03-11      12:13:39:330
2014-03-11      12:13:39:538
2014-03-11      12:13:39:538
2014-03-11      12:13:39:820
2014-03-11      12:13:39:825
2014-03-11      12:13:39:930
2014-03-11      12:13:39:930
2014-03-11      12:13:40:125
2014-03-11      12:13:40:128
2014-03-11      12:13:46:128
2014-03-11      12:13:46:128
2014-03-11      12:13:52:867
2014-03-11      12:13:52:869
2014-03-11      12:13:53:127
2014-03-11      12:13:53:127
2014-03-11      12:13:53:424
2014-03-11      12:13:53:425
2014-03-11      12:13:53:578
2014-03-11      12:13:53:578
2014-03-11      12:13:53:868
2014-03-11      12:13:53:869
2014-03-11      12:13:54:024
2014-03-11      12:13:54:024
2014-03-11      12:13:54:192
2014-03-11      12:13:54:192
2014-03-11      14:00:23:737
2014-03-11      14:34:07:302
2014-03-11      14:34:07:302
2014-03-11      14:34:35:538
2014-03-11      14:34:35:538
2014-03-11      14:35:53:133
2014-03-11      14:35:53:133
2014-03-11      14:35:54:739
2014-03-11      14:35:54:739
2014-03-11      14:36:08:670
2014-03-11      14:36:08:670
2014-03-11      14:36:18:514
2014-03-11      14:36:18:514
2014-03-11      14:36:20:183
2014-03-11      14:36:20:183
2014-03-11      14:36:28:857
2014-03-11      14:36:28:857
2014-03-11      14:36:38:497
2014-03-11      14:36:38:497
2014-03-11      14:36:46:297
2014-03-11      14:36:46:297
2014-03-11      14:36:53:848
2014-03-11      14:36:53:848
2014-03-11      14:37:01:523
2014-03-11      14:37:01:523
2014-03-11      22:46:57:785



select Evendate as even, count(*)  as count
from WindowsUpdate
WHERE Text LIKE '%DnldMgr: New download job%'
GROUP BY Evendate
order by count desc
LIMIT 1;

2014-03-11      132






